<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Direitos Previdenci√°rios - ReVive</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --dark: #1f2937;
            --light: #f3f4f6;
            --white: #ffffff;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="%23ffffff" fill-opacity="0.05" d="M0,96L48,112C96,128,192,160,288,186.7C384,213,480,235,576,213.3C672,192,768,128,864,128C960,128,1056,192,1152,213.3C1248,235,1344,213,1392,202.7L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
            pointer-events: none;
            z-index: 0;
        }
        
        .app-container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
            animation: slideDown 0.5s ease-out;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .logo-text h1 {
            font-size: 1.75rem;
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.25rem;
        }
        
        .logo-text p {
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        .header-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .nav-link {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .nav-link:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            color: white;
            text-decoration: none;
        }
        
        .btn-contrato {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-contrato:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            color: white;
            text-decoration: none;
        }
        
        .content-wrapper {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            min-height: 600px;
            animation: fadeIn 0.5s ease-out 0.2s both;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .analise-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .analise-header {
            margin-bottom: 2rem;
            text-align: center;
        }

        .pergunta-card {
            background: #f9fafb;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            animation: fadeIn 0.3s ease-out;
            border: 2px solid #e5e7eb;
        }

        .pergunta-titulo {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .opcoes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .opcao-btn {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--dark);
            text-align: left;
        }

        .opcao-btn:hover {
            border-color: var(--primary);
            background: #f3f4f6;
            transform: translateY(-2px);
        }

        .opcao-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .ajuda-text {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
            line-height: 1.4;
        }

        .btn-continuar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1rem auto 0;
            display: block;
        }

        .btn-continuar:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-continuar:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .resultado-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .resultado-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .resultado-card.alta {
            border-left: 4px solid var(--success);
        }

        .resultado-card.media {
            border-left: 4px solid var(--warning);
        }

        .resultado-card.baixa {
            border-left: 4px solid var(--info);
        }

        .resultado-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .resultado-titulo {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .certeza-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .certeza-alta {
            background: #d1fae5;
            color: #047857;
        }

        .certeza-media {
            background: #fef3c7;
            color: #92400e;
        }

        .certeza-baixa {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .resultado-motivo {
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .resultado-acoes {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn-info, .btn-docs {
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-info {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
        }

        .btn-docs {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-info:hover, .btn-docs:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow);
            text-decoration: none;
        }

        .btn-docs:hover {
            background: var(--primary);
            color: white;
        }

        .respostas-resumo {
            background: #f9fafb;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            font-size: 0.875rem;
            border: 1px solid #e5e7eb;
        }

        .respostas-resumo h4 {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.1rem;
        }

        .resposta-item {
            display: flex;
            justify-content: space-between;
            padding: 0.35rem 0;
            color: #6b7280;
            border-bottom: 1px dashed #e5e7eb;
        }
        .resposta-item:last-child {
            border-bottom: none;
        }

        .resposta-valor {
            font-weight: 500;
            color: var(--dark);
            text-align: right;
            margin-left: 1rem;
        }

        .alert-acumulacao {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: start;
            gap: 0.75rem;
        }

        .alert-acumulacao .icon {
            font-size: 1.25rem;
            color: #92400e;
        }

        .alert-acumulacao .content {
            color: #92400e;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
        }
        
        .empty-icon {
            font-size: 4rem;
            color: #e5e7eb;
            margin-bottom: 1rem;
        }
        
        .empty-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }
        
        .empty-text {
            color: #6b7280;
        }

        .explicacao-personalizada {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .explicacao-content {
            color: #0369a1;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .explicacao-content ul {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
        }

        .explicacao-content li {
            margin-bottom: 0.25rem;
        }

        .explicacao-highlight {
            background: #dbeafe;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-weight: 600;
            color: #1e40af;
        }

        .final-actions {
            text-align: center;
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 1rem;
            }
            .header, .content-wrapper {
                padding: 1rem;
                border-radius: 16px;
            }
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
            
            .opcoes-grid {
                 grid-template-columns: 1fr;
            }
            
            .resultado-acoes {
                flex-direction: column;
                gap: 0.75rem;
            }
            .resultado-acoes .btn-info, .resultado-acoes .btn-docs {
                width: 100%;
                justify-content: center;
            }
            
            .final-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .final-actions .btn-contrato,
            .final-actions .btn-continuar {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">üîç</div>
                    <div class="logo-text">
                        <h1>An√°lise de Direitos Previdenci√°rios</h1>
                        <p>Sistema Inteligente de An√°lise Completa - Vers√£o 2025</p>
                    </div>
                </div>
                <div class="header-actions">
                    <a href="#" class="nav-link" onclick="reiniciarAnalise()">
                        <span>üîÑ</span>
                        <span>Nova An√°lise</span>
                    </a>
                    <a href="https://app.zapsign.com.br/verificar/doc/9088c21f-820c-4a1f-9ea9-c5fb749579c1" class="btn-contrato" target="_blank">
                        <span>üìù</span>
                        <span>Preencher Novo Contrato</span>
                    </a>
                </div>
            </div>
        </header>
        
        <main class="content-wrapper">
            <div class="analise-container">
                <div class="analise-header">
                    <h2 style="font-size: 1.75rem; font-weight: 700; color: var(--dark); margin-bottom: 1rem;">
                        üéØ An√°lise Completa de Direitos Previdenci√°rios
                    </h2>
                    <p style="color: #6b7280; margin-bottom: 2rem; max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                        Sistema avan√ßado que identifica <strong>todos os benef√≠cios</strong> que o cliente pode ter direito, incluindo possibilidades de <strong>acumula√ß√£o</strong> e benef√≠cios simult√¢neos. Baseado nas regras atuais de 2025.
                    </p>
                </div>
                <div class="analise-content">
                    <div class="perguntas-container" id="perguntasContainer">
                        <!-- Perguntas ser√£o renderizadas aqui -->
                    </div>
                    <div class="resultados-container" id="resultadosContainer" style="display: none;">
                        <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--dark); margin-bottom: 1.5rem; text-align: center;">
                            üìä An√°lise Completa de Benef√≠cios
                        </h3>
                        <div id="resultadosContent">
                            <!-- Resultados da an√°lise ser√£o renderizados aqui -->
                        </div>
                        <div class="final-actions">
                            <button class="btn-continuar" onclick="reiniciarAnalise()">
                                üîÑ Nova An√°lise Completa
                            </button>
                            <a href="https://app.zapsign.com.br/verificar/doc/9088c21f-820c-4a1f-9ea9-c5fb749579c1" class="btn-contrato" target="_blank">
                                üìù Preencher Novo Contrato
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script>
        // ==================================================
        // DADOS E CONSTANTES GLOBAIS
        // ==================================================
        const SALARIO_MINIMO_2025 = 1518.00;
        const LIMITE_BPC_UM_QUARTO = SALARIO_MINIMO_2025 / 4; // 379.50
        const LIMITE_BPC_MEIO = SALARIO_MINIMO_2025 / 2;     // 759.00
        
        const processosInfo = {
            'auxilio-doenca': { icon: 'üè•', title: 'Aux√≠lio-Doen√ßa (Incapacidade Tempor√°ria)' },
            'aposentadoria-invalidez': { icon: '‚ôø', title: 'Aposentadoria por Invalidez (Incapacidade Permanente)' },
            'auxilio-acidente': { icon: 'ü©π', title: 'Aux√≠lio-Acidente (Indenizat√≥rio)' },
            'seguro-vida': { icon: 'üõ°Ô∏è', title: 'Seguro de Vida' },
            'auxilio-maternidade': { icon: 'üë∂', title: 'Sal√°rio-Maternidade' },
            'bpc-loas': { icon: 'ü§ù', title: 'BPC/LOAS (Assistencial)' },
            'aposentadoria-idade': { icon: 'üë¥', title: 'Aposentadoria por Idade' },
            'aposentadoria-tempo': { icon: '‚è∞', title: 'Aposentadoria por Tempo de Contribui√ß√£o' },
            'pensao-morte': { icon: 'üíî', title: 'Pens√£o por Morte' },
            'dpvat': { icon: 'üöó', title: 'DPVAT (Seguro Obrigat√≥rio)' },
            'dpvat-obito': { icon: '‚ö∞Ô∏è', title: 'DPVAT √ìbito' },
            'seguro-terceiro': { icon: 'üöô', title: 'Seguro de Terceiro' },
            'acao-acidente-transito': { icon: '‚öñÔ∏è', title: 'A√ß√£o de Acidente de Tr√¢nsito' },
            'fraude': { icon: 'üö®', title: 'A√ß√£o por Fraude/Golpe' }
        };

        // Lista de doen√ßas graves que dispensam car√™ncia (2025)
        const doencasGraves = [
            'tuberculose_ativa', 'hanseniase', 'alienacao_mental', 'esclerose_multipla',
            'hepatopatia_grave', 'neoplasia_maligna', 'cegueira', 'paralisia_irreversivel',
            'cardiopatia_grave', 'doenca_parkinson', 'espondiloartrose_anquilosante',
            'nefropatia_grave', 'estado_avancado_doenca_paget', 'sindrome_deficiencia_imunologica',
            'contaminacao_radiacao', 'sindrome_talidomida', 'acidente_vascular_encef√°lico_agudo',
            'abdome_agudo_cirurgico'
        ];

        const analiseProcessos = {
            perguntas: {
                situacao: {
                    titulo: 'Quais situa√ß√µes se aplicam ao cliente? (Pode marcar v√°rias)',
                    icon: 'üéØ',
                    multiple: true,
                    opcoes: [
                        { valor: 'acidente', label: 'Sofreu acidente', icon: 'üö®' },
                        { valor: 'doenca', label: 'Est√° doente/incapacitado', icon: 'üè•' },
                        { valor: 'idade_aposentar', label: 'Quer se aposentar por idade/tempo', icon: 'üë¥' },
                        { valor: 'falecimento', label: 'Falecimento de familiar', icon: 'üíî' },
                        { valor: 'fraude', label: 'Foi v√≠tima de golpe/fraude', icon: 'üö®' },
                        { valor: 'maternidade', label: 'Gravidez/Nascimento de filho', icon: 'üë∂' },
                        { valor: 'deficiencia', label: 'Pessoa com defici√™ncia (BPC)', icon: '‚ôø' }
                    ]
                },

                tipoAcidente: {
                    titulo: 'Que tipo de acidente?',
                    icon: 'üöó',
                    condicao: (respostas) => respostas.situacao && respostas.situacao.includes('acidente'),
                    opcoes: [
                        { valor: 'transito', label: 'Acidente de tr√¢nsito', icon: 'üöó' },
                        { valor: 'trabalho', label: 'Acidente de trabalho', icon: 'üè≠' },
                        { valor: 'domestico', label: 'Acidente dom√©stico', icon: 'üè†' },
                        { valor: 'outro', label: 'Outro tipo de acidente', icon: '‚ö†Ô∏è' }
                    ]
                },

                dataAcidente: {
                    titulo: 'Quando ocorreu o acidente?',
                    icon: 'üìÖ',
                    condicao: (respostas) => respostas.situacao && respostas.situacao.includes('acidente'),
                    tipo: 'date',
                    ajuda: 'Data do acidente (importante para DPVAT e prazos)'
                },

                gravidade: {
                    titulo: 'Qual a gravidade das les√µes/sequelas?',
                    icon: 'ü©π',
                    condicao: (respostas) => respostas.situacao && (respostas.situacao.includes('acidente') || respostas.situacao.includes('doenca')),
                    opcoes: [
                        { valor: 'permanente_total', label: 'Incapacidade permanente e total', icon: '‚ôø' },
                        { valor: 'permanente_parcial', label: 'Sequelas permanentes parciais', icon: 'ü©π' },
                        { valor: 'temporaria_grave', label: 'Incapacidade tempor√°ria grave (>15 dias)', icon: 'üè•' },
                        { valor: 'temporaria_leve', label: 'Incapacidade tempor√°ria leve (<15 dias)', icon: 'ü§í' },
                        { valor: 'sem_incapacidade', label: 'Sem incapacidade significativa', icon: '‚úÖ' },
                        { valor: 'nao_sei', label: 'Ainda n√£o sei/em avalia√ß√£o', icon: '‚ùì' }
                    ]
                },

                tempoIncapacidade: {
                    titulo: 'H√° quanto tempo est√° incapacitado para o trabalho?',
                    icon: '‚è≥',
                    condicao: (respostas) => 
                        respostas.gravidade === 'temporaria_grave' || respostas.gravidade === 'permanente_total' || respostas.gravidade === 'permanente_parcial',
                    opcoes: [
                        { valor: 'menos15', label: 'Menos de 15 dias', icon: 'üìÖ' },
                        { valor: '15_60', label: '15 dias a 2 meses', icon: 'üìÜ' },
                        { valor: '2_6meses', label: '2 a 6 meses', icon: 'üóìÔ∏è' },
                        { valor: '6_12meses', label: '6 meses a 1 ano', icon: 'üìÖ' },
                        { valor: 'mais1ano', label: 'Mais de 1 ano', icon: 'üóìÔ∏è' },
                        { valor: 'mais2anos', label: 'Mais de 2 anos', icon: 'üìÜ' }
                    ]
                },

                tipoDoenca: {
                    titulo: 'Qual tipo de doen√ßa/condi√ß√£o?',
                    icon: '‚öïÔ∏è',
                    condicao: (respostas) => respostas.situacao && respostas.situacao.includes('doenca'),
                    opcoes: [
                        { valor: 'cancer', label: 'C√¢ncer (neoplasia maligna)', icon: 'üéóÔ∏è' },
                        { valor: 'cardiopatia_grave', label: 'Cardiopatia grave', icon: '‚ù§Ô∏è' },
                        { valor: 'mental', label: 'Transtorno mental/psiqui√°trico', icon: 'üß†' },
                        { valor: 'hiv', label: 'HIV/AIDS', icon: 'üî¨' },
                        { valor: 'nefropatia_grave', label: 'Doen√ßa renal cr√¥nica grave', icon: 'üè•' },
                        { valor: 'tuberculose_ativa', label: 'Tuberculose ativa', icon: 'ü´Å' },
                        { valor: 'esclerose_multipla', label: 'Esclerose m√∫ltipla', icon: 'üß†' },
                        { valor: 'hanseniase', label: 'Hansen√≠ase', icon: '‚öïÔ∏è' },
                        { valor: 'parkinson', label: 'Doen√ßa de Parkinson', icon: 'üßì' },
                        { valor: 'hepatopatia_grave', label: 'Hepatopatia grave', icon: 'üè•' },
                        { valor: 'cegueira', label: 'Cegueira', icon: 'üëÅÔ∏è' },
                        { valor: 'paralisia_irreversivel', label: 'Paralisia irrevers√≠vel', icon: '‚ôø' },
                        { valor: 'outra_grave', label: 'Outra doen√ßa grave', icon: '‚öïÔ∏è' },
                        { valor: 'outra', label: 'Outra doen√ßa comum', icon: 'üè•' }
                    ]
                },

                vinculoTrabalho: {
                    titulo: 'Qual a situa√ß√£o de trabalho atual?',
                    icon: 'üíº',
                    opcoes: [
                        { valor: 'clt', label: 'Empregado CLT', icon: 'üíº' },
                        { valor: 'mei', label: 'MEI (Microempreendedor)', icon: 'üè™' },
                        { valor: 'autonomo', label: 'Aut√¥nomo/Contribuinte individual', icon: 'üë§' },
                        { valor: 'rural', label: 'Trabalhador rural', icon: 'üåæ' },
                        { valor: 'domestico', label: 'Empregado dom√©stico', icon: 'üè†' },
                        { valor: 'servidor', label: 'Servidor p√∫blico', icon: 'üèõÔ∏è' },
                        { valor: 'desempregado', label: 'Desempregado', icon: 'üö´' },
                        { valor: 'aposentado', label: 'J√° aposentado', icon: 'üë¥' },
                        { valor: 'nunca_trabalhou', label: 'Nunca trabalhou', icon: '‚ùå' }
                    ]
                },

                dataUltimoEmprego: {
                    titulo: 'Quando foi seu √∫ltimo emprego/trabalho com registro?',
                    icon: 'üìÖ',
                    condicao: (respostas) => respostas.vinculoTrabalho === 'desempregado',
                    tipo: 'date',
                    ajuda: 'Data de sa√≠da do √∫ltimo emprego (importante para verificar qualidade de segurado)'
                },

                tempoDesempregado: {
                    titulo: 'H√° quanto tempo est√° desempregado?',
                    icon: '‚è∞',
                    condicao: (respostas) => respostas.vinculoTrabalho === 'desempregado',
                    opcoes: [
                        { valor: 'menos6meses', label: 'Menos de 6 meses', icon: 'üìÖ' },
                        { valor: '6a12meses', label: '6 meses a 1 ano', icon: 'üìÜ' },
                        { valor: '1a2anos', label: '1 a 2 anos', icon: 'üóìÔ∏è' },
                        { valor: '2a3anos', label: '2 a 3 anos', icon: 'üìÖ' },
                        { valor: 'mais3anos', label: 'Mais de 3 anos', icon: 'üóìÔ∏è' }
                    ]
                },

                recebeSeguroDesemprego: {
                    titulo: 'Recebe ou recebeu seguro-desemprego recentemente?',
                    icon: 'üí∞',
                    condicao: (respostas) => respostas.vinculoTrabalho === 'desempregado',
                    opcoes: [
                        { valor: 'sim_recebendo', label: 'Sim, ainda estou recebendo', icon: '‚úÖ' },
                        { valor: 'sim_recebi_ano', label: 'Recebi no √∫ltimo ano', icon: 'üìÖ' },
                        { valor: 'sim_recebi_2anos', label: 'Recebi h√° 1-2 anos', icon: 'üóìÔ∏è' },
                        { valor: 'nao_recebi', label: 'N√£o recebi', icon: '‚ùå' },
                        { valor: 'nao_sei', label: 'N√£o sei/lembro', icon: '‚ùì' }
                    ]
                },

                contribuiuAposDesemprego: {
                    titulo: 'Ap√≥s sair do emprego, contribuiu como aut√¥nomo/MEI?',
                    icon: 'üßæ',
                    condicao: (respostas) => respostas.vinculoTrabalho === 'desempregado',
                    opcoes: [
                        { valor: 'sim_sempre', label: 'Sim, todo m√™s desde que sa√≠', icon: '‚úÖ' },
                        { valor: 'sim_alguns_meses', label: 'Sim, alguns meses', icon: 'üìÖ' },
                        { valor: 'parei_recente', label: 'Contribu√≠a, mas parei recentemente', icon: '‚è∏Ô∏è' },
                        { valor: 'nunca_contribui', label: 'Nunca contribu√≠ ap√≥s sair', icon: '‚ùå' },
                        { valor: 'nao_sei', label: 'N√£o sei/lembro', icon: '‚ùì' }
                    ]
                },

                dataUltimaContribuicao: {
                    titulo: 'Quando foi sua √∫ltima contribui√ß√£o ao INSS?',
                    icon: 'üìÖ',
                    condicao: (respostas) => 
                        respostas.vinculoTrabalho === 'desempregado' || 
                        (respostas.contribuiuAposDesemprego && ['parei_recente', 'sim_alguns_meses'].includes(respostas.contribuiuAposDesemprego)),
                    tipo: 'date',
                    ajuda: 'M√™s/ano da √∫ltima contribui√ß√£o (pode ser aproximado)'
                },

                tempoContribuicao: {
                    titulo: 'Quanto tempo TOTAL de contribui√ß√£o ao INSS?',
                    icon: 'üßæ',
                    condicao: (respostas) => respostas.vinculoTrabalho !== 'nunca_trabalhou',
                    opcoes: [
                        { valor: '0', label: 'Nunca contribuiu', icon: '‚≠ï' },
                        { valor: 'menos1', label: 'Menos de 1 ano', icon: 'üìÖ' },
                        { valor: '1a5', label: '1 a 5 anos', icon: 'üìÜ' },
                        { valor: '5a10', label: '5 a 10 anos', icon: 'üóìÔ∏è' },
                        { valor: '10a15', label: '10 a 15 anos', icon: 'üìÖ' },
                        { valor: '15a20', label: '15 a 20 anos', icon: 'üóìÔ∏è' },
                        { valor: '20a30', label: '20 a 30 anos', icon: 'üìÜ' },
                        { valor: '30a35', label: '30 a 35 anos', icon: 'üéØ' },
                        { valor: 'mais35', label: 'Mais de 35 anos', icon: 'üèÜ' },
                        { valor: 'nao_sei', label: 'N√£o sei calcular', icon: '‚ùì' }
                    ],
                    ajuda: 'Some todo tempo de carteira assinada + contribui√ß√µes como aut√¥nomo/MEI. Se n√£o souber, coloque "N√£o sei calcular"'
                },

                idade: {
                    titulo: 'Qual a idade do cliente?',
                    icon: 'üéÇ',
                    tipo: 'number',
                    min: 0,
                    max: 120,
                    ajuda: 'Digite a idade em anos completos'
                },

                sexo: {
                    titulo: 'Qual o sexo do cliente?',
                    icon: 'üöª',
                    opcoes: [
                        { valor: 'masculino', label: 'Masculino', icon: 'üë®' },
                        { valor: 'feminino', label: 'Feminino', icon: 'üë©' }
                    ]
                },

                rendaFamiliar: {
                    titulo: 'Qual a renda familiar por pessoa (per capita) mensal?',
                    icon: 'üí∞',
                    condicao: (respostas) => 
                        (respostas.situacao && respostas.situacao.includes('deficiencia')) ||
                        (respostas.idade && parseInt(respostas.idade) >= 65),
                    opcoes: [
                        { valor: 'menos_1_4', label: `Menos de 1/4 sal√°rio m√≠nimo (R$ ${LIMITE_BPC_UM_QUARTO.toFixed(2).replace('.',',')})`, icon: 'üíµ' },
                        { valor: 'ate_1_2', label: `Entre 1/4 e 1/2 sal√°rio m√≠nimo (R$ ${LIMITE_BPC_UM_QUARTO.toFixed(2).replace('.',',')} - R$ ${LIMITE_BPC_MEIO.toFixed(2).replace('.',',')})`, icon: 'üí∞' },
                        { valor: 'mais_1_2', label: `Mais de 1/2 sal√°rio m√≠nimo (+ R$ ${LIMITE_BPC_MEIO.toFixed(2).replace('.',',')})`, icon: 'üí∏' },
                        { valor: 'nao_sei', label: 'N√£o sei calcular', icon: '‚ùì' }
                    ],
                    ajuda: `Some toda a renda da fam√≠lia e divida pelo n√∫mero de pessoas que moram na casa. Sal√°rio m√≠nimo 2025: R$ ${SALARIO_MINIMO_2025.toFixed(2).replace('.',',')}`
                },

                seguroVida: {
                    titulo: 'Tinha/tem seguro de vida? (Pode marcar mais de um)',
                    icon: 'üõ°Ô∏è',
                    condicao: (respostas) => 
                        respostas.situacao && (respostas.situacao.includes('acidente') || respostas.situacao.includes('falecimento')),
                    multiple: true,
                    opcoes: [
                        { valor: 'sim_empresa', label: 'Sim, pela empresa/empregador', icon: 'üè¢' },
                        { valor: 'sim_individual', label: 'Sim, individual/banco', icon: 'üè¶' },
                        { valor: 'sim_app', label: 'Sim, por app de entrega/transporte', icon: 'üì±' },
                        { valor: 'sim_consorcio', label: 'Sim, por cons√≥rcio', icon: 'üöó' },
                        { valor: 'nao', label: 'N√£o tinha', icon: '‚ùå' },
                        { valor: 'nao_sei', label: 'N√£o sei', icon: '‚ùì' }
                    ]
                },
                
                // <<<<<<< IN√çCIO DA NOVA PERGUNTA >>>>>>>
                dataFimTratamento: {
                    titulo: 'Quando o tratamento m√©dico foi finalizado?',
                    icon: 'üèÅ',
                    condicao: (respostas) => 
                        respostas.seguroVida && !respostas.seguroVida.includes('nao') &&
                        !respostas.seguroVida.includes('nao_sei') &&
                        (respostas.gravidade === 'permanente_parcial' || respostas.gravidade === 'permanente_total'),
                    tipo: 'date',
                    ajuda: 'Data em que o tratamento foi conclu√≠do (alta m√©dica). Importante para o prazo do seguro de vida (geralmente 1 ano ap√≥s a alta).'
                },
                // <<<<<<< FIM DA NOVA PERGUNTA >>>>>>>

                qualApp: {
                    titulo: 'Qual aplicativo estava usando no momento do acidente?',
                    icon: 'üì±',
                    condicao: (respostas) => 
                        respostas.seguroVida && respostas.seguroVida.includes('sim_app') &&
                        respostas.situacao && respostas.situacao.includes('acidente'),
                    opcoes: [
                        { valor: 'ifood', label: 'iFood', icon: 'üçî' },
                        { valor: 'rappi', label: 'Rappi', icon: 'üõµ' },
                        { valor: 'uber_eats', label: 'Uber Eats', icon: 'üçï' },
                        { valor: 'uber', label: 'Uber (passageiros)', icon: 'üöó' },
                        { valor: '99', label: '99 (passageiros)', icon: 'üöô' },
                        { valor: 'loggi', label: 'Loggi', icon: 'üì¶' },
                        { valor: 'outro_delivery', label: 'Outro app de delivery', icon: 'üõµ' },
                        { valor: 'outro_transporte', label: 'Outro app de transporte', icon: 'üöó' },
                        { valor: 'nao_estava_trabalhando', label: 'N√£o estava trabalhando no app', icon: '‚ùå' }
                    ],
                    ajuda: 'Cada app tem regras de cobertura diferentes - seja espec√≠fico sobre qual estava usando'
                },

                statusTrabalhoApp: {
                    titulo: 'Qual era seu status no app no momento do acidente?',
                    icon: 'üì±',
                    condicao: (respostas) => 
                        respostas.qualApp && respostas.qualApp !== 'nao_estava_trabalhando',
                    opcoes: [
                        { valor: 'em_entrega', label: 'Em entrega/corrida ativa', icon: 'üèÉ‚Äç‚ôÇÔ∏è' },
                        { valor: 'voltando_casa', label: 'Voltando para casa ap√≥s entrega', icon: 'üè†' },
                        { valor: 'indo_retirar', label: 'Indo retirar pedido', icon: 'üè™' },
                        { valor: 'online_aguardando', label: 'Online aguardando pedidos', icon: '‚è∞' },
                        { valor: 'offline', label: 'Estava offline', icon: 'üì¥' },
                        { valor: 'nao_sei', label: 'N√£o lembro exatamente', icon: '‚ùì' }
                    ],
                    ajuda: 'Importante: cada status tem cobertura diferente'
                },

                terceiroCausador: {
                    titulo: 'O acidente de tr√¢nsito foi causado por terceiro?',
                    icon: 'üöó',
                    condicao: (respostas) => respostas.tipoAcidente === 'transito',
                    opcoes: [
                        { valor: 'sim_seguro', label: 'Sim, e ele tem seguro', icon: 'üõ°Ô∏è' },
                        { valor: 'sim_sem_seguro', label: 'Sim, mas n√£o tem seguro', icon: 'üö´' },
                        { valor: 'nao_identificado', label: 'N√£o foi identificado/fugiu', icon: '‚ùì' },
                        { valor: 'cliente_causador', label: 'Cliente foi o causador', icon: 'üôã' },
                        { valor: 'sem_culpado', label: 'Sem culpado definido', icon: '‚öñÔ∏è' },
                        { valor: 'nao_sei', label: 'N√£o sei informar', icon: '‚ùì' }
                    ]
                },

                tipoFraude: {
                    titulo: 'Que tipo de golpe/fraude?',
                    icon: 'üïµÔ∏è',
                    condicao: (respostas) => respostas.situacao && respostas.situacao.includes('fraude'),
                    opcoes: [
                        { valor: 'pix', label: 'Golpe do PIX', icon: 'üì±' },
                        { valor: 'cartao', label: 'Fraude no cart√£o', icon: 'üí≥' },
                        { valor: 'emprestimo', label: 'Empr√©stimo fraudulento', icon: 'üè¶' },
                        { valor: 'investimento', label: 'Falso investimento', icon: 'üìà' },
                        { valor: 'compra_online', label: 'Compra online fraudulenta', icon: 'üõí' },
                        { valor: 'whatsapp', label: 'Golpe do WhatsApp', icon: 'üìû' },
                        { valor: 'falso_banco', label: 'Falso funcion√°rio de banco', icon: 'üèõÔ∏è' },
                        { valor: 'outro', label: 'Outro tipo de golpe', icon: 'üö®' }
                    ]
                },

                parentescoFalecido: {
                    titulo: 'Qual o parentesco com o falecido?',
                    icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
                    condicao: (respostas) => respostas.situacao && respostas.situacao.includes('falecimento'),
                    opcoes: [
                        { valor: 'conjuge', label: 'C√¥njuge/Companheiro(a)', icon: 'üíë' },
                        { valor: 'filho', label: 'Filho(a)', icon: 'üë∂' },
                        { valor: 'pai_mae', label: 'Pai/M√£e', icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶' },
                        { valor: 'irmao', label: 'Irm√£o/Irm√£', icon: 'üë´' },
                        { valor: 'outro', label: 'Outro parente', icon: 'üë•' }
                    ]
                },

                beneficiosAtuais: {
                    titulo: 'J√° recebe algum benef√≠cio do INSS ou outro √≥rg√£o?',
                    icon: 'üí∞',
                    multiple: true,
                    opcoes: [
                        { valor: 'nenhum', label: 'N√£o recebo nenhum benef√≠cio', icon: '‚ùå' },
                        { valor: 'aposentadoria_inss', label: 'Aposentadoria do INSS', icon: 'üë¥' },
                        { valor: 'auxilio_doenca', label: 'Aux√≠lio-doen√ßa', icon: 'üè•' },
                        { valor: 'auxilio_acidente', label: 'Aux√≠lio-acidente', icon: 'ü©π' },
                        { valor: 'pensao_morte', label: 'Pens√£o por morte', icon: 'üíî' },
                        { valor: 'bpc_loas', label: 'BPC/LOAS', icon: 'ü§ù' },
                        { valor: 'servidor_publico', label: 'Aposentadoria servidor p√∫blico', icon: 'üèõÔ∏è' },
                        { valor: 'militar', label: 'Benef√≠cio militar', icon: 'ü™ñ' },
                        { valor: 'outros', label: 'Outros benef√≠cios', icon: 'üìã' }
                    ]
                }
            },
            
            calcularProcessos: function(respostas) {
                const processosAlta = [];
                const processosMedia = [];
                const processosBaixa = [];
                const observacoes = [];
                
                const situacoes = respostas.situacao || [];
                
                const temQualidadeSegurado = (respostas) => {
                    if (respostas.vinculoTrabalho === 'aposentado') return true;
                    if (['clt', 'mei', 'autonomo', 'domestico', 'servidor', 'rural'].includes(respostas.vinculoTrabalho)) return true;
                    
                    if (respostas.vinculoTrabalho === 'desempregado') {
                        const hoje = new Date();
                        
                        if (respostas.recebeSeguroDesemprego === 'sim_recebendo') return true;
                        if (respostas.recebeSeguroDesemprego === 'sim_recebi_ano') return true;
                        
                        if (respostas.contribuiuAposDesemprego === 'sim_sempre') return true;
                        
                        if (respostas.dataUltimaContribuicao) {
                            const ultimaContrib = new Date(respostas.dataUltimaContribuicao + '-01');
                            const mesesSemContrib = (hoje - ultimaContrib) / (1000 * 60 * 60 * 24 * 30);
                            
                            if (mesesSemContrib <= 12) return true;
                            
                            const tempoTotal = getTempoContribuicaoMeses(respostas.tempoContribuicao);
                            if (tempoTotal >= 120 && mesesSemContrib <= 36) return true;
                        }
                        
                        if (respostas.dataUltimoEmprego) {
                            const ultimoEmprego = new Date(respostas.dataUltimoEmprego);
                            const mesesSemEmprego = (hoje - ultimoEmprego) / (1000 * 60 * 60 * 24 * 30);
                            
                            if (mesesSemEmprego <= 12) return true;
                            
                            const tempoTotal = getTempoContribuicaoMeses(respostas.tempoContribuicao);
                            if (tempoTotal >= 120 && mesesSemEmprego <= 36) return true;
                        }
                        
                        return false;
                    }
                    
                    return respostas.tempoContribuicao && respostas.tempoContribuicao !== '0';
                };

                const temCarencia = (mesesNecessarios) => {
                    const tempoContrib = getTempoContribuicaoMeses(respostas.tempoContribuicao);
                    return tempoContrib >= mesesNecessarios;
                };

                const isDoencaGrave = (tipoDoenca) => {
                    return doencasGraves.includes(tipoDoenca);
                };

                // AUX√çLIO-DOEN√áA
                if (situacoes.includes('doenca') || situacoes.includes('acidente')) {
                    if (respostas.gravidade && 
                        ['temporaria_grave', 'permanente_parcial', 'permanente_total'].includes(respostas.gravidade) &&
                        respostas.tempoIncapacidade && respostas.tempoIncapacidade !== 'menos15') {
                        
                        if (temQualidadeSegurado(respostas)) {
                            const isAcidente = situacoes.includes('acidente');
                            const isDoencaGraveVal = respostas.tipoDoenca && isDoencaGrave(respostas.tipoDoenca);
                            const temCarencia12 = temCarencia(12);
                            
                            if (isAcidente || isDoencaGraveVal || temCarencia12) {
                                let motivo = 'Incapacidade tempor√°ria com qualidade de segurado. ';
                                if (isAcidente) motivo += 'Acidente dispensa car√™ncia. ';
                                if (isDoencaGraveVal) motivo += 'Doen√ßa grave dispensa car√™ncia. ';
                                if (!isAcidente && !isDoencaGraveVal) motivo += 'Cumpre car√™ncia de 12 meses. ';
                                
                                processosAlta.push({
                                    key: 'auxilio-doenca',
                                    certeza: 'alta',
                                    motivo: motivo
                                });
                            } else {
                                processosBaixa.push({
                                    key: 'auxilio-doenca',
                                    certeza: 'baixa',
                                    motivo: 'Incapacidade presente, mas n√£o cumpre car√™ncia de 12 meses'
                                });
                            }
                        } else {
                            processosBaixa.push({
                                key: 'auxilio-doenca',
                                certeza: 'baixa',
                                motivo: 'Incapacidade presente, mas perdeu qualidade de segurado'
                            });
                        }
                    }
                }

                // APOSENTADORIA POR INVALIDEZ
                if (respostas.gravidade === 'permanente_total') {
                    if (temQualidadeSegurado(respostas)) {
                        const isAcidente = situacoes.includes('acidente');
                        const isDoencaGraveVal = respostas.tipoDoenca && isDoencaGrave(respostas.tipoDoenca);
                        const temCarencia12 = temCarencia(12);
                        
                        if (isAcidente || isDoencaGraveVal || temCarencia12) {
                            processosAlta.push({
                                key: 'aposentadoria-invalidez',
                                certeza: 'alta',
                                motivo: 'Incapacidade permanente e total. Necess√°ria per√≠cia m√©dica para confirma√ß√£o.'
                            });
                        } else {
                            processosMedia.push({
                                key: 'aposentadoria-invalidez',
                                certeza: 'media',
                                motivo: 'Incapacidade permanente presente, mas n√£o cumpre car√™ncia de 12 meses'
                            });
                        }
                    } else {
                        processosBaixa.push({
                            key: 'aposentadoria-invalidez',
                            certeza: 'baixa',
                            motivo: 'Incapacidade permanente, mas perdeu qualidade de segurado'
                        });
                    }
                }
                
                if (respostas.gravidade === 'permanente_parcial' && 
                    (respostas.tempoIncapacidade === 'mais1ano' || respostas.tempoIncapacidade === 'mais2anos')) {
                    processosMedia.push({
                        key: 'aposentadoria-invalidez',
                        certeza: 'media',
                        motivo: 'Incapacidade prolongada - pode evoluir para invalidez total. Analisar com per√≠cia.'
                    });
                }

                // AUX√çLIO-ACIDENTE
                if (situacoes.includes('acidente') && respostas.gravidade === 'permanente_parcial') {
                    if (respostas.vinculoTrabalho === 'mei') {
                        processosBaixa.push({
                            key: 'auxilio-acidente',
                            certeza: 'baixa',
                            motivo: 'O MEI (Microempreendedor Individual) n√£o possui direito ao aux√≠lio-acidente, conforme a legisla√ß√£o previdenci√°ria.'
                        });
                    } else {
                        if (temQualidadeSegurado(respostas)) {
                            processosAlta.push({
                                key: 'auxilio-acidente',
                                certeza: 'alta',
                                motivo: 'Sequelas permanentes de acidente. Benef√≠cio indenizat√≥rio que pode acumular com outros.'
                            });
                        } else {
                            processosMedia.push({
                                key: 'auxilio-acidente',
                                certeza: 'media',
                                motivo: 'Sequelas permanentes, mas pode ter perdido a qualidade de segurado - analisar caso.'
                            });
                        }
                    }
                }

                // <<<<<<<<<<<<<<<<<<< IN√çCIO DA CORRE√á√ÉO SOLICITADA: SEGURO DE VIDA >>>>>>>>>>>>>>>>>>>>
                if (situacoes.includes('acidente') || situacoes.includes('falecimento')) {
                    if (respostas.seguroVida && !respostas.seguroVida.includes('nao') && !respostas.seguroVida.includes('nao_sei')) {
                        // Invalidez Permanente (trigger para a regra de 1 ano)
                        if (respostas.gravidade && ['permanente_parcial', 'permanente_total'].includes(respostas.gravidade)) {
                            if (respostas.dataFimTratamento) {
                                const hoje = new Date();
                                const fimTratamento = new Date(respostas.dataFimTratamento + "T00:00:00");
                                const diffTime = hoje - fimTratamento;
                                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                                if (diffDays <= 365) {
                                    processosAlta.push({
                                        key: 'seguro-vida',
                                        certeza: 'alta',
                                        motivo: 'Prazo vigente. O processo deve ser aberto no m√°ximo 1 ano ap√≥s a finaliza√ß√£o do tratamento/consolida√ß√£o das les√µes.'
                                    });
                                } else {
                                    processosBaixa.push({
                                        key: 'seguro-vida',
                                        certeza: 'baixa',
                                        motivo: 'Prazo expirado. O per√≠odo de 1 ano ap√≥s o fim do tratamento para abrir o processo parece ter passado. Analisar ap√≥lice para exce√ß√µes.'
                                    });
                                }
                            } else {
                                processosMedia.push({
                                    key: 'seguro-vida',
                                    certeza: 'media',
                                    motivo: 'Seguro existente e les√£o grave. √â crucial verificar a data de alta m√©dica para confirmar se ainda est√° dentro do prazo de 1 ano para acionar.'
                                });
                            }
                        }
                        // Caso de morte
                        else if (situacoes.includes('falecimento')) {
                            processosAlta.push({
                                key: 'seguro-vida',
                                certeza: 'alta',
                                motivo: 'Em caso de falecimento, o prazo para os benefici√°rios acionarem o seguro √© diferente (geralmente maior). Verificar ap√≥lice.'
                            });
                        }
                        // Incapacidade tempor√°ria (algumas ap√≥lices cobrem)
                        else if (respostas.gravidade === 'temporaria_grave') {
                             processosMedia.push({
                                key: 'seguro-vida',
                                certeza: 'media',
                                motivo: 'Seguro de vida pode cobrir incapacidade tempor√°ria (DIT - Di√°ria por Incapacidade Tempor√°ria). Verificar condi√ß√µes da ap√≥lice.'
                            });
                        }
                    }
                }
                // <<<<<<<<<<<<<<<<<<<<<<<< FIM DA CORRE√á√ÉO SOLICITADA >>>>>>>>>>>>>>>>>>>>>>>>>>>>>

                // BPC/LOAS com a nova regra
                if (situacoes.includes('deficiencia') || (respostas.idade && parseInt(respostas.idade) >= 65)) {
                    const motivoBase = (situacoes.includes('deficiencia') ? 'Defici√™ncia' : 'Idade 65+');
                    
                    if (respostas.rendaFamiliar === 'menos_1_4') {
                        processosAlta.push({
                            key: 'bpc-loas',
                            certeza: 'alta',
                            motivo: `${motivoBase}. Renda per capita abaixo do crit√©rio de 1/4 do sal√°rio m√≠nimo (R$ ${LIMITE_BPC_UM_QUARTO.toFixed(2).replace('.',',')}). Alta chance de aprova√ß√£o.`
                        });
                    } else if (respostas.rendaFamiliar === 'ate_1_2') {
                        processosAlta.push({
                            key: 'bpc-loas',
                            certeza: 'alta', 
                            motivo: `${motivoBase}. Com a nova regra, a renda de at√© 1/2 do sal√°rio m√≠nimo (R$ ${LIMITE_BPC_MEIO.toFixed(2).replace('.',',')}) pode ser aceita ap√≥s a dedu√ß√£o de despesas comprovadas (aluguel, rem√©dios, etc.).`
                        });
                    }
                }

                // APOSENTADORIAS
                if (situacoes.includes('idade_aposentar') && respostas.idade && respostas.sexo && 
                    respostas.tempoContribuicao && temQualidadeSegurado(respostas)) {
                    const idade = parseInt(respostas.idade);
                    const anosContrib = getTempoContribuicaoMeses(respostas.tempoContribuicao) / 12;

                    if (respostas.vinculoTrabalho === 'rural') {
                        if ((respostas.sexo === 'feminino' && idade >= 55 && anosContrib >= 15) ||
                            (respostas.sexo === 'masculino' && idade >= 60 && anosContrib >= 15)) {
                            processosAlta.push({ key: 'aposentadoria-idade', certeza: 'alta', motivo: 'Atende requisitos para aposentadoria por idade rural' });
                        }
                    } else {
                        if ((respostas.sexo === 'feminino' && idade >= 62 && anosContrib >= 15) ||
                            (respostas.sexo === 'masculino' && idade >= 65 && anosContrib >= 15)) {
                            processosAlta.push({ key: 'aposentadoria-idade', certeza: 'alta', motivo: 'Atende requisitos para aposentadoria por idade urbana' });
                        }
                        if ((respostas.sexo === 'feminino' && anosContrib >= 30) || (respostas.sexo === 'masculino' && anosContrib >= 35)) {
                            processosMedia.push({ key: 'aposentadoria-tempo', certeza: 'media', motivo: 'Alto tempo de contribui√ß√£o - verificar regras de transi√ß√£o p√≥s-Reforma' });
                        }
                    }
                }

                // SAL√ÅRIO-MATERNIDADE
                if (situacoes.includes('maternidade')) {
                    if (respostas.sexo === 'feminino') {
                        if (temQualidadeSegurado(respostas)) {
                            processosAlta.push({ key: 'auxilio-maternidade', certeza: 'alta', motivo: 'STF 2024 eliminou car√™ncia - basta qualidade de segurado' });
                        } else {
                            processosMedia.push({ key: 'auxilio-maternidade', certeza: 'media', motivo: 'Sem qualidade de segurado - poss√≠vel contribui√ß√£o como individual' });
                        }
                    } else if (respostas.sexo === 'masculino') {
                        processosMedia.push({ key: 'auxilio-maternidade', certeza: 'media', motivo: 'Homem segurado - direito em caso de ado√ß√£o ou guarda judicial' });
                    }
                }

                // PENS√ÉO POR MORTE
                if (situacoes.includes('falecimento') && respostas.parentescoFalecido) {
                    let certeza = 'media';
                    let motivo = 'Dependente de segurado falecido. ';
                    if (['conjuge', 'filho'].includes(respostas.parentescoFalecido)) {
                        certeza = 'alta';
                        motivo += 'Depend√™ncia presumida (classe 1). ';
                    } else {
                        motivo += 'Necess√°rio comprovar depend√™ncia econ√¥mica. ';
                    }
                    motivo += 'Verificar qualidade de segurado do falecido.';
                    if (certeza === 'alta') {
                        processosAlta.push({ key: 'pensao-morte', certeza, motivo });
                    } else {
                        processosMedia.push({ key: 'pensao-morte', certeza, motivo });
                    }
                }

                // AN√ÅLISES ADICIONAIS DE BAIXA PROBABILIDADE
                if (situacoes.includes('deficiencia') && respostas.rendaFamiliar === 'mais_1_2') {
                    processosBaixa.push({
                        key: 'bpc-loas',
                        certeza: 'baixa',
                        motivo: 'Renda familiar acima do limite, mas poss√≠vel contesta√ß√£o judicial em casos especiais (despesas muito altas).'
                    });
                }

                // DPVAT E SEGUROS DE TR√ÇNSITO
                if (respostas.tipoAcidente === 'transito' && respostas.dataAcidente) {
                    const dataAcidenteDate = new Date(respostas.dataAcidente + "T00:00:00");
                    const dataLimiteDPVAT = new Date('2023-11-14T23:59:59');
                    
                    if (dataAcidenteDate <= dataLimiteDPVAT) {
                        if (respostas.gravidade && ['permanente_parcial', 'permanente_total', 'temporaria_grave'].includes(respostas.gravidade)) {
                            processosAlta.push({ key: 'dpvat', certeza: 'alta', motivo: 'Acidente de tr√¢nsito com les√µes antes de 14/11/2023' });
                        } else if (respostas.gravidade === 'temporaria_leve') {
                            processosMedia.push({ key: 'dpvat', certeza: 'media', motivo: 'Acidente antes da extin√ß√£o, mas les√µes leves - verificar cobertura' });
                        }
                    }
                    
                    if (respostas.terceiroCausador === 'sim_seguro') {
                        processosAlta.push({ key: 'seguro-terceiro', certeza: 'alta', motivo: 'Terceiro causador com seguro - processo administrativo' });
                    } else if (respostas.terceiroCausador === 'sim_sem_seguro') {
                        processosMedia.push({ key: 'acao-acidente-transito', certeza: 'media', motivo: 'Terceiro identificado sem seguro - a√ß√£o judicial dependente de patrim√¥nio' });
                    } else if (respostas.terceiroCausador === 'sem_culpado') {
                        processosMedia.push({ key: 'acao-acidente-transito', certeza: 'media', motivo: 'Sem culpado definido - poss√≠vel a√ß√£o judicial para esclarecimento de responsabilidade' });
                    } else if (respostas.terceiroCausador === 'nao_identificado') {
                        processosBaixa.push({ key: 'acao-acidente-transito', certeza: 'baixa', motivo: 'Terceiro n√£o identificado - dificuldade para a√ß√£o de repara√ß√£o' });
                    }
                }

                // FRAUDE
                if (situacoes.includes('fraude') && respostas.tipoFraude) {
                    const tipoFraudeTexto = {
                        'pix': 'PIX', 'cartao': 'cart√£o', 'emprestimo': 'empr√©stimo', 'investimento': 'falso investimento', 
                        'compra_online': 'compra online', 'whatsapp': 'WhatsApp', 'falso_banco': 'falso funcion√°rio de banco', 'outro': 'golpe'
                    };
                    processosMedia.push({ key: 'fraude', certeza: 'media', motivo: `V√≠tima de golpe do ${tipoFraudeTexto[respostas.tipoFraude]} - a√ß√£o civil/criminal` });
                }

                // VERIFICAR ACUMULA√á√ïES
                if (processosAlta.length > 1 || processosMedia.length > 0) {
                    let podeAcumular = [];
                    let naoAcumula = [];
                    const beneficiosIdentificados = [...processosAlta, ...processosMedia].map(p => p.key);
                    
                    if (beneficiosIdentificados.includes('auxilio-acidente')) podeAcumular.push('Aux√≠lio-acidente PODE acumular com pens√£o por morte e aposentadorias');
                    if (beneficiosIdentificados.includes('pensao-morte')) podeAcumular.push('Pens√£o por morte PODE acumular com aposentadoria (com desconto p√≥s-2019)');
                    if (beneficiosIdentificados.includes('auxilio-doenca') && beneficiosIdentificados.includes('aposentadoria-invalidez')) naoAcumula.push('Aux√≠lio-doen√ßa N√ÉO acumula com aposentadoria por invalidez');
                    if (beneficiosIdentificados.includes('bpc-loas') && (beneficiosIdentificados.includes('aposentadoria_inss') || beneficiosIdentificados.includes('pensao_morte'))) naoAcumula.push('BPC/LOAS N√ÉO acumula com aposentadoria ou pens√£o por morte');
                    
                    if (podeAcumular.length > 0 || naoAcumula.length > 0) {
                        observacoes.push({ tipo: 'acumulacao', titulo: 'Regras de Acumula√ß√£o de Benef√≠cios', podeAcumular, naoAcumula });
                    }
                }

                return { alta: processosAlta, media: processosMedia, baixa: processosBaixa, observacoes: observacoes };
            }
        };

        // FUN√á√ïES AUXILIARES
        function getTempoContribuicaoMeses(tempo) {
            const tempoMap = {
                '0': 0, 'menos1': 6, '1a5': 36, '5a10': 90, '10a15': 150, '15a20': 210, 
                '20a30': 300, '30a35': 390, 'mais35': 480, 'nao_sei': 60
            };
            return tempoMap[tempo] || 0;
        }
        
        function getInfoSeguroApp(qualApp, statusTrabalho) {
            const info = { nome: '', valores: '', temCobertura: false, motivoCobertura: '' };
            switch(qualApp) {
                case 'rappi':
                    info.nome = 'Rappi';
                    info.valores = 'Morte: R$ 100.000 | Invalidez: at√© R$ 100.000 | Despesas m√©dicas: R$ 30.000 | Funeral: R$ 5.000 | DIT: R$ 100/dia (ap√≥s 11¬∫ dia, at√© 30 di√°rias)';
                    if (statusTrabalho === 'em_entrega') { info.temCobertura = true; info.motivoCobertura = 'COBERTO - Estava realizando entrega pela Rappi'; } 
                    else { info.temCobertura = false; info.motivoCobertura = 'N√ÉO COBERTO - Rappi s√≥ cobre durante entrega ativa'; }
                    break;
                case 'ifood':
                    info.nome = 'iFood';
                    info.valores = 'Invalidez permanente: at√© R$ 60.000';
                    if (['em_entrega', 'voltando_casa', 'indo_retirar'].includes(statusTrabalho)) { info.temCobertura = true; info.motivoCobertura = 'COBERTO - iFood cobre entrega + trajeto volta (at√© 30km/1h ap√≥s √∫ltima entrega)'; } 
                    else { info.temCobertura = false; info.motivoCobertura = 'N√ÉO COBERTO - Fora do per√≠odo de cobertura do iFood'; }
                    break;
                default:
                    info.nome = 'App n√£o especificado';
                    info.valores = 'Verificar ap√≥lice espec√≠fica';
                    info.temCobertura = false;
                    info.motivoCobertura = 'ANALISAR CASO A CASO - Cada app tem regras pr√≥prias';
            }
            return info;
        }

        // ==================================================
        // L√ìGICA DA APLICA√á√ÉO
        // ==================================================
        const respostasAnalise = {};
        let perguntaAtualIdx = 0;
        const ordemPerguntasAnalise = [
            'situacao', 'tipoAcidente', 'dataAcidente', 'gravidade', 'tempoIncapacidade', 'tipoDoenca', 
            'vinculoTrabalho', 'dataUltimoEmprego', 'tempoDesempregado', 'recebeSeguroDesemprego', 
            'contribuiuAposDesemprego', 'dataUltimaContribuicao', 'tempoContribuicao', 'idade', 'sexo', 
            'rendaFamiliar', 'seguroVida', 'dataFimTratamento', 'qualApp', 'statusTrabalhoApp', 'terceiroCausador', 'tipoFraude',
            'parentescoFalecido', 'beneficiosAtuais'
        ];

        const perguntasContainer = document.getElementById('perguntasContainer');
        const resultadosContainer = document.getElementById('resultadosContainer');
        const resultadosContent = document.getElementById('resultadosContent');

        function renderizarPerguntaAnalise() {
            if (!perguntasContainer) return;
            
            perguntasContainer.innerHTML = '';

            let perguntaRenderizada = false;
            while(perguntaAtualIdx < ordemPerguntasAnalise.length && !perguntaRenderizada) {
                const perguntaKey = ordemPerguntasAnalise[perguntaAtualIdx];
                const perguntaConfig = analiseProcessos.perguntas[perguntaKey];

                if (!perguntaConfig || (perguntaConfig.condicao && !perguntaConfig.condicao(respostasAnalise))) {
                    perguntaAtualIdx++;
                    continue;
                }

                const card = document.createElement('div');
                card.className = 'pergunta-card';
                let inputHtml = '';

                if (perguntaConfig.opcoes) {
                    inputHtml = `<div class="opcoes-grid">`;
                    perguntaConfig.opcoes.forEach(opcao => {
                        inputHtml += `<button class="opcao-btn" data-pergunta="${perguntaKey}" data-valor="${opcao.valor}" ${perguntaConfig.multiple ? 'data-multiple="true"' : ''}>
                                        <span style="font-size: 1.2em;">${opcao.icon}</span>
                                        <span>${opcao.label}</span>
                                    </button>`;
                    });
                    inputHtml += `</div>`;
                } else if (perguntaConfig.tipo === 'date') {
                    inputHtml = `<input type="date" id="resposta-${perguntaKey}" class="input-field">`;
                } else {
                    inputHtml = `<input type="number" id="resposta-${perguntaKey}" class="input-field" 
                                    ${perguntaConfig.min !== undefined ? `min="${perguntaConfig.min}"` : ''}
                                    ${perguntaConfig.max !== undefined ? `max="${perguntaConfig.max}"` : ''}>`;
                }

                card.innerHTML = `<div class="pergunta-titulo"><span>${perguntaConfig.icon || '‚ùì'}</span><span>${perguntaConfig.titulo}</span></div>
                                  ${inputHtml}
                                  ${perguntaConfig.ajuda ? `<p class="ajuda-text">${perguntaConfig.ajuda}</p>` : ''}`;
                perguntasContainer.appendChild(card);

                if (perguntaConfig.opcoes) {
                    if (perguntaConfig.multiple) {
                        card.querySelectorAll('.opcao-btn').forEach(btn => {
                            btn.addEventListener('click', () => {
                                if (!respostasAnalise[perguntaKey]) respostasAnalise[perguntaKey] = [];
                                const valor = btn.dataset.valor;
                                if (btn.classList.contains('selected')) {
                                    btn.classList.remove('selected');
                                    respostasAnalise[perguntaKey] = respostasAnalise[perguntaKey].filter(v => v !== valor);
                                } else {
                                    btn.classList.add('selected');
                                    if (!respostasAnalise[perguntaKey].includes(valor)) respostasAnalise[perguntaKey].push(valor);
                                }
                            });
                        });
                        const btnContinuar = document.createElement('button');
                        btnContinuar.textContent = 'Continuar An√°lise';
                        btnContinuar.className = 'btn-continuar';
                        btnContinuar.onclick = () => {
                            if (respostasAnalise[perguntaKey] && respostasAnalise[perguntaKey].length > 0) avancarPerguntaAnalise();
                            else alert("Por favor, selecione ao menos uma op√ß√£o para continuar.");
                        };
                        card.appendChild(btnContinuar);
                    } else {
                        card.querySelectorAll('.opcao-btn').forEach(btn => {
                            btn.addEventListener('click', () => {
                                respostasAnalise[perguntaKey] = btn.dataset.valor;
                                card.querySelectorAll('.opcao-btn').forEach(b => b.classList.remove('selected'));
                                btn.classList.add('selected');
                                setTimeout(avancarPerguntaAnalise, 300);
                            });
                        });
                    }
                } else {
                    const btnContinuar = document.createElement('button');
                    btnContinuar.textContent = 'Continuar An√°lise';
                    btnContinuar.className = 'btn-continuar';
                    btnContinuar.onclick = () => {
                        const inputEl = document.getElementById(`resposta-${perguntaKey}`);
                        if (inputEl && inputEl.value.trim() !== '') {
                            respostasAnalise[perguntaKey] = inputEl.value;
                            avancarPerguntaAnalise();
                        } else {
                            alert("Por favor, forne√ßa uma resposta para continuar.");
                        }
                    };
                    card.appendChild(btnContinuar);
                }
                perguntaRenderizada = true;
            }

            if (!perguntaRenderizada) {
                mostrarResultadosAnalise();
            }
        }

        function avancarPerguntaAnalise() {
            perguntaAtualIdx++;
            renderizarPerguntaAnalise();
        }

        function mostrarResultadosAnalise() {
            perguntasContainer.style.display = 'none';
            resultadosContainer.style.display = 'block';
            resultadosContent.innerHTML = '';

            const { alta, media, baixa, observacoes } = analiseProcessos.calcularProcessos(respostasAnalise);
            
            let htmlResultados = '<div class="respostas-resumo"><h4>üìã Resumo das Informa√ß√µes Coletadas:</h4>';
            for (const key in respostasAnalise) {
                if (respostasAnalise.hasOwnProperty(key) && analiseProcessos.perguntas[key]) {
                    const perguntaCfg = analiseProcessos.perguntas[key];
                    let valorResposta = respostasAnalise[key];
                    if (Array.isArray(valorResposta)) {
                        valorResposta = valorResposta.map(val => (perguntaCfg.opcoes?.find(o => o.valor === val) || {label: val}).label).join(', ');
                    } else if (perguntaCfg.opcoes) {
                        valorResposta = (perguntaCfg.opcoes.find(o => o.valor === valorResposta) || {label: valorResposta}).label;
                    }
                    if (valorResposta) {
                        htmlResultados += `<div class="resposta-item">
                            <span>${perguntaCfg.titulo.replace(/\?.*/, '').replace('Qual ', '').trim()}:</span>
                            <span class="resposta-valor">${valorResposta}</span>
                        </div>`;
                    }
                }
            }
            htmlResultados += '</div>';

            if (observacoes.length > 0) {
                observacoes.forEach(obs => {
                    if (obs.tipo === 'acumulacao') {
                        htmlResultados += `<div class="alert-acumulacao"><div class="icon">‚öñÔ∏è</div><div class="content">
                            <strong>${obs.titulo}</strong><br>
                            ${obs.podeAcumular.map(item => `‚úÖ ${item}`).join('<br>')}
                            ${obs.naoAcumula.length > 0 ? '<br>' + obs.naoAcumula.map(item => `‚ùå ${item}`).join('<br>') : ''}
                        </div></div>`;
                    }
                });
            }

            if (alta.length === 0 && media.length === 0 && baixa.length === 0) {
                htmlResultados += `<div class="empty-state"><div class="empty-icon">üîç</div>
                    <div class="empty-title">An√°lise Inconclusiva</div>
                    <div class="empty-text">Com base nas informa√ß√µes, n√£o foi poss√≠vel identificar benef√≠cios. Considere uma consulta para an√°lise detalhada.</div></div>`;
            } else {
                if (alta.length > 0) {
                    htmlResultados += `<h4 style="text-align:center; margin-bottom:1rem; font-size:1.3rem; color:var(--success);">üéØ Benef√≠cios com Alta Probabilidade (${alta.length}):</h4>`;
                    alta.forEach(p => {
                        const processoInfo = processosInfo[p.key];
                        if (processoInfo) htmlResultados += criarCardResultado(processoInfo, p, 'alta');
                    });
                }
                if (media.length > 0) {
                    htmlResultados += `<h4 style="text-align:center; margin-top:2rem; margin-bottom:1rem; font-size:1.2rem; color:var(--warning);">‚öñÔ∏è Benef√≠cios com M√©dia Probabilidade (${media.length}):</h4>`;
                    media.forEach(p => {
                        const processoInfo = processosInfo[p.key];
                        if (processoInfo) htmlResultados += criarCardResultado(processoInfo, p, 'media');
                    });
                }
                if (baixa.length > 0) {
                    htmlResultados += `<h4 style="text-align:center; margin-top:2rem; margin-bottom:1rem; font-size:1.1rem; color:var(--info);">üîç Benef√≠cios para An√°lise Detalhada (${baixa.length}):</h4>`;
                    baixa.forEach(p => {
                        const processoInfo = processosInfo[p.key];
                        if (processoInfo) htmlResultados += criarCardResultado(processoInfo, p, 'baixa');
                    });
                }
            }
            resultadosContent.innerHTML = htmlResultados;
        }

        function criarCardResultado(processoInfo, processo, nivel) {
            return `<div class="resultado-card ${nivel}">
                        <div class="resultado-header">
                            <div class="resultado-titulo"><span>${processoInfo.icon}</span><span>${processoInfo.title}</span></div>
                            <span class="certeza-badge certeza-${nivel}">${processo.certeza.toUpperCase()}</span>
                        </div>
                        <p class="resultado-motivo">${processo.motivo}</p>
                        <div class="resultado-acoes">
                            <a href="#" class="btn-info">üìã Ver Documentos</a>
                            <button class="btn-docs">üìñ Mais Informa√ß√µes</button>
                        </div>
                    </div>`;
        }

        function reiniciarAnalise() {
            for (const key in respostasAnalise) delete respostasAnalise[key];
            perguntaAtualIdx = 0;
            resultadosContainer.style.display = 'none';
            perguntasContainer.style.display = 'block';
            renderizarPerguntaAnalise();
        }

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', renderizarPerguntaAnalise);
    </script>
</body>
</html>
